{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.CID_GRPA = exports.CID_BABE = exports.CID_AURA = void 0;\n\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\n\nvar _util = require(\"@polkadot/util\");\n\nvar _U = _interopRequireDefault(require(\"../primitive/U32\")); // Copyright 2017-2020 @polkadot/types authors & contributors\n// This software may be modified and distributed under the terms\n// of the Apache-2.0 license. See the LICENSE file for details.\n\n\nconst CID_AURA = 0x61727561; // 'aura'\n\nexports.CID_AURA = CID_AURA;\nconst CID_BABE = 0x45424142; // 'BABE'\n\nexports.CID_BABE = CID_BABE;\nconst CID_GRPA = 0x4b4e5246; // 'FRNK' (don't ask, used to be afg1)\n\nexports.CID_GRPA = CID_GRPA;\n/**\n * @name ConsensusEngineId\n * @description\n * A 4-byte identifier (actually a [u8; 4]) identifying the engine, e.g. for Aura it would be [b'a', b'u', b'r', b'a']\n */\n\nclass ConsensusEngineId extends _U.default {\n  static idToString(input) {\n    return (0, _util.bnToBn)(input).toArray('le').map(code => String.fromCharCode(code)).join('');\n  }\n\n  static stringToId(input) {\n    return input.split('').reverse().reduce((result, char) => result * 256 + char.charCodeAt(0), 0);\n  }\n  /**\n   * @description `true` if the engine matches aura\n   */\n\n\n  get isAura() {\n    return this.eq(CID_AURA);\n  }\n  /**\n   * @description `true` is the engine matches babe\n   */\n\n\n  get isBabe() {\n    return this.eq(CID_BABE);\n  }\n  /**\n   * @description `true` is the engine matches grandpa\n   */\n\n\n  get isGrandpa() {\n    return this.eq(CID_GRPA);\n  }\n\n  _getAuraAuthor(bytes, sessionValidators) {\n    return sessionValidators[this.registry.createType('RawAuraPreDigest', bytes.toU8a(true)).slotNumber.mod(new _bn.default(sessionValidators.length)).toNumber()];\n  }\n\n  _getBabeAuthor(bytes, sessionValidators) {\n    const digest = this.registry.createType('RawBabePreDigestCompat', bytes.toU8a(true));\n    return sessionValidators[digest.value.toNumber()];\n  }\n  /**\n   * @description From the input bytes, decode into an author\n   */\n\n\n  extractAuthor(bytes, sessionValidators) {\n    if (sessionValidators === null || sessionValidators === void 0 ? void 0 : sessionValidators.length) {\n      if (this.isAura) {\n        return this._getAuraAuthor(bytes, sessionValidators);\n      } else if (this.isBabe) {\n        return this._getBabeAuthor(bytes, sessionValidators);\n      }\n    }\n\n    return undefined;\n  }\n  /**\n   * @description Override the default toString to return a 4-byte string\n   */\n\n\n  toString() {\n    return ConsensusEngineId.idToString(this);\n  }\n\n}\n\nexports.default = ConsensusEngineId;","map":null,"metadata":{},"sourceType":"script"}