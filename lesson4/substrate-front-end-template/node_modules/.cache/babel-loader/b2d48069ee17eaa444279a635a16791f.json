{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _util = require(\"@polkadot/util\");\n\nvar _U8aFixed = _interopRequireDefault(require(\"../codec/U8aFixed\"));\n\nvar _Bool = _interopRequireDefault(require(\"../primitive/Bool\")); // Copyright 2017-2020 @polkadot/types authors & contributors\n// This software may be modified and distributed under the terms\n// of the Apache-2.0 license. See the LICENSE file for details.\n// For votes, the topmost bit indicated aye/nay, the lower bits indicate the conviction\n\n\nconst AYE_BITS = 0b10000000;\nconst NAY_BITS = 0b00000000;\nconst CON_MASK = 0b01111111;\nconst DEF_CONV = 0b00000000; // the default conviction, None\n\n/** @internal */\n\nfunction decodeVoteBool(value) {\n  return value ? new Uint8Array([AYE_BITS | DEF_CONV]) : new Uint8Array([NAY_BITS]);\n}\n/** @internal */\n\n\nfunction decodeVoteU8a(value) {\n  return value.length ? value.subarray(0, 1) : new Uint8Array([NAY_BITS]);\n}\n/** @internal */\n\n\nfunction decodeVote(registry, value) {\n  if ((0, _util.isUndefined)(value) || value instanceof Boolean || (0, _util.isBoolean)(value)) {\n    return decodeVoteBool(new _Bool.default(registry, value).isTrue);\n  } else if ((0, _util.isNumber)(value)) {\n    return decodeVoteBool(value < 0);\n  } else if ((0, _util.isU8a)(value)) {\n    return decodeVoteU8a(value);\n  }\n\n  const vote = new _Bool.default(registry, value.aye).isTrue ? AYE_BITS : NAY_BITS;\n  const conviction = registry.createType('Conviction', (0, _util.isUndefined)(value.conviction) ? DEF_CONV : value.conviction);\n  return new Uint8Array([vote | conviction.index]);\n}\n/**\n * @name Vote\n * @description\n * A number of lock periods, plus a vote, one way or the other.\n */\n\n\nclass Vote extends _U8aFixed.default {\n  constructor(registry, value) {\n    // decoded is just 1 byte\n    // Aye: Most Significant Bit\n    // Conviction: 0000 - 0101\n    const decoded = decodeVote(registry, value);\n    super(registry, decoded, 8);\n    this._aye = void 0;\n    this._conviction = void 0;\n    this._aye = (decoded[0] & AYE_BITS) === AYE_BITS;\n    this._conviction = this.registry.createType('Conviction', decoded[0] & CON_MASK);\n  }\n  /**\n   * @description returns a V2 conviction\n   */\n\n\n  get conviction() {\n    return this._conviction;\n  }\n  /**\n   * @description true if the wrapped value is a positive vote\n   */\n\n\n  get isAye() {\n    return this._aye;\n  }\n  /**\n   * @description true if the wrapped value is a negative vote\n   */\n\n\n  get isNay() {\n    return !this.isAye;\n  }\n  /**\n   * @description Converts the Object to to a human-friendly JSON, with additional fields, expansion and formatting of information\n   */\n\n\n  toHuman(isExpanded) {\n    return {\n      conviction: this.conviction.toHuman(isExpanded),\n      vote: this.isAye ? 'Aye' : 'Nay'\n    };\n  }\n  /**\n   * @description Returns the base runtime type name for this instance\n   */\n\n\n  toRawType() {\n    return 'Vote';\n  }\n\n}\n\nexports.default = Vote;","map":null,"metadata":{},"sourceType":"script"}